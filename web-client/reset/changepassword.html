<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon -->
    <link rel=icon type=image/x-icon href=../assets/favicon.png>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Learned Bootstrap Tutorial From -->
    <!-- https://getbootstrap.com/-->

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/25ed10730a.js" crossorigin="anonymous"></script>

    <!-- Personalized CSS -->
    <link rel="stylesheet" href="reset.css">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <!-- JS -->

    <script type="text/javascript" src="../loading/loading.js"></script>
    <script>
        window.onload = function() {
            pageload();
            document.querySelector('.button').onclick = function() {
                // var password = document.getElementById("pswd").value;
                // var confirmP = document.getElementById("confirm").value;
                // console.log(password);
                // console.log(confirmP);
                // if (password == "") {
                //     alert("Please enter your new password.");
                //     return false;
                // } else if (password != confirmP) {
                //     alert("Passwords didn't match, please try again.");
                //     return false;
                // } else {
                //     var url = 'http://127.0.0.1:8000/user/' + localStorage.getItem("user") + '/profile';
                //     $.ajax({
                //         url: url,
                //         type: 'PATCH',
                //         cache: false,
                //         data: {
                //             password: password
                //         },
                //         success: function(data, textStatus) {
                //             window.location.href = '../login/login.html';
                //             localStorage.setItem("user", null);
                //             alert("Password successfully reset!");
                //         },
                //         error: function(jqXHR, textStatus, err) {
                //             alert("There was an error resetting your password.");
                //             return false;
                //         }
                //     });
                // }
            }
        }
    </script>

    <script>
        window.onclick = function () {
            pageclick();
        };
    </script>
    <title>Change Password</title>

</head>

<body>
    <div class="signup-form">
        <form action="" id="" method="POST">
            <!-- Header -->
            <div class="text-center" id="container">
                <a href="../login/login.html"><i class="health-icon fas fa-running"></i></a>
                <h2>Change Password</h2>
            </div>
            <hr>

            <!-- Username -->
            <!-- <div class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><i
                            class="animate__animated animate__slideInLeft fas fa-user-shield"></i></span>
                    <input type="text" class="form-control" name="username" id="user" placeholder="Username" required="required">
                </div>
            </div> -->

            <!-- Email -->
            <!-- <div class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fas fa-envelope"></i></span>
                    <input type="email" class="form-control" name="email" placeholder="Email" required="required">
                </div>
            </div> -->

            <!-- Password -->
            <div class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fas fa-key"></i></span>
                    <input type="password" id="pswd" class="form-control" name="password" placeholder="New Password" required="required">
                </div>
            </div>

            <!-- Confirm Password -->
            <div class="form-group">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fas fa-key"></i></span>
                    <input type="password" id="confirm" class="form-control" name="password" placeholder="Confirm Password" required="required">
                </div>
            </div>

            <div class="form-group row">
                <div class="col-sm-12 text-center">
                    <p></p>
                    <button type="submit" id="change" class="button btn btn-signup btn-lg btn-block">Change
                        Password</button>
                </div>

            </div>
            <img id="We're Werking on it..." src="../../Loading_Assets/Loading_GT1_Client_Wait.gif" hidden />
            <div id="We're Werking on it text" hidden="true">
                One moment, We're Werking on Your Network Connection...
            </div>
            <!-- <div class="form-group row">
                <div class="col-sm-12 text-center">
                    <p>Want to Change Username, Instead?</p>
                    <a href="../username/username.html" class="btn btn-login btn-lg btn-block" role="button">Change
                        Username</a>
                </div>
            </div> -->

    </div>
    </div>
    <script>
        var $btn = $('#change');

        $btn.on('click', function(event) {
            event.preventDefault();
            var password = document.getElementById("pswd").value;
            var confirmP = document.getElementById("confirm").value;
            console.log(password);
            console.log(confirmP);
            if (password == "") {
                alert("Please enter your new password.");
                return false;
            } else if (password != confirmP) {
                alert("Passwords didn't match, please try again.");
                return false;
            } else {
                var url = 'http://127.0.0.1:8000/user/' + localStorage.getItem("user") + '/profile';
                $.ajax({
                    url: url,
                    type: 'PATCH',
                    cache: false,
                    data: {
                        password: password
                    },
                    success: function(data, textStatus) {
                        window.location.href = '../login/login.html';
                        localStorage.setItem("user", null);
                        alert("Your password was successfully reset!");
                    },
                    error: function(jqXHR, textStatus, err) {
                        alert("There was an error resetting your password.");
                        return false;
                    }
                });
            }
        });
    </script>
</body>

</html>